<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reddit Archiver</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container mt-4">
        <h1>Reddit Archiver</h1>

        <div class="card mb-4">
            <div class="card-header">
                <h2 class="h5 mb-0">Archive Reddit Users</h2>
            </div>
            <div class="card-body">
                <form id="archive-form">
                    <div class="mb-3">
                        <label class="form-label">Input Method:</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="inputMethod" id="username-input"
                                value="username" checked>
                            <label class="form-check-label" for="username-input">
                                Single Username
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="inputMethod" id="file-input"
                                value="file">
                            <label class="form-check-label" for="file-input">
                                Upload User List
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="inputMethod" id="folder-input"
                                value="folders">
                            <label class="form-check-label" for="folder-input">
                                From Existing Folders
                            </label>
                        </div>
                    </div>

                    <div id="username-section" class="mb-3">
                        <label for="username" class="form-label">Reddit Username:</label>
                        <input type="text" class="form-control" id="username" name="username">
                    </div>

                    <div id="file-section" class="mb-3" style="display: none;">
                        <label for="userFile" class="form-label">Upload user list (one username per line):</label>
                        <input class="form-control" type="file" id="userFile" name="userFile">
                        <div id="file-users" class="mt-2" style="display: none;">
                            <p><strong>Users found:</strong> <span id="user-count">0</span></p>
                            <div class="users-preview"></div>
                        </div>
                    </div>

                    <div id="folder-section" class="mb-3" style="display: none;">
                        <p>Found user folders:</p>
                        <div id="folder-users" class="users-preview">
                            Loading...
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="limit" class="form-label">Download Limit:</label>
                            <input type="number" class="form-control" id="limit" name="limit" value="100" min="1"
                                max="1000">
                        </div>
                        <div class="col-md-6">
                            <label for="concurrent" class="form-label">Concurrent Downloads:</label>
                            <input type="number" class="form-control" id="concurrent" name="concurrent" value="10"
                                min="1" max="20">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">Start Archiving</button>
                </form>
            </div>
        </div>

        <div id="active-job" class="card mb-4" style="display: none;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h2 class="h5 mb-0">Active Job</h2>
                <button id="stop-job" class="btn btn-sm btn-danger">Stop Job</button>
            </div>
            <div class="card-body">
                <div class="job-details mb-3">
                    <p><strong>Status:</strong> <span id="job-status">Running</span></p>
                    <p><strong>Progress:</strong> <span id="job-progress">0/0</span> users processed</p>
                    <div class="progress mb-2">
                        <div id="job-progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                </div>

                <h3 class="h6">Log Messages</h3>
                <div id="log-container" class="log-container mb-3">
                    <div id="log-messages"></div>
                </div>

                <h3 class="h6">Active Downloads</h3>
                <div id="downloads-container">
                    <!-- Download items will be added here dynamically -->
                </div>

                <h3 class="h6">Duplicate Removal Progress</h3>
                <div id="duplicate-container">
                    <!-- Duplicate removal items will be added here dynamically -->
                </div>
            </div>
        </div>

        <div id="completed-jobs" class="card">
            <div class="card-header">
                <h2 class="h5 mb-0">Job History</h2>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Status</th>
                                <th>Users</th>
                                <th>Started</th>
                                <th>Completed</th>
                            </tr>
                        </thead>
                        <tbody id="jobs-table-body">
                            <tr>
                                <td colspan="5">No jobs completed yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script src="js/app.js"></script>
</body>

</html>